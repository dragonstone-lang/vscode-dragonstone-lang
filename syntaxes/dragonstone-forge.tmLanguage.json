{
    "$schema":          "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
    "name":             "Dragonstone Forge",
    "fileTypes": [
        "forge"
    ],
    "firstLineMatch":   "^#!\\/.*\\bforge\\b",
    "patterns": [
        { "include": "#comments"        },
        { "include": "#tableHeaders"    },
        { "include": "#assignments"     },
        { "include": "#values"          }
    ],
    "repository": {
        "comments": {
            "patterns": [
                {
                    "name":     "comment.block.dragonstone-forge",
                    "begin":    "#\\[",
                    "end":      "\\]#",
                    "beginCaptures": {
                        "0":    { "name": "punctuation.definition.comment.begin.dragonstone-forge"      }
                    },
                    "endCaptures": {
                        "0":    { "name": "punctuation.definition.comment.end.dragonstone-forge"        }
                    }
                },
                {
                    "name":     "comment.line.number-sign.dragonstone-forge",
                    "match":    "#(?!\\[).*$",
                    "captures": {
                        "0":    { "name": "punctuation.definition.comment.dragonstone-forge"            }
                    }
                }
            ]
        },
        "tableHeaders": {
            "patterns": [
                {
                    "name":     "meta.section.table.dragonstone-forge",
                    "match":    "^\\s*(\\[)(\\[)?\\s*((?i:package|target|dependencies|development\\s+dependencies|registry|dragonstone\\s+version\\s+required))\\s*(\\])?(\\])\\s*(?:#.*)?$",
                    "captures": {
                        "1":    { "name": "punctuation.definition.section.begin.dragonstone-forge"      },
                        "2":    { "name": "punctuation.definition.section.begin.dragonstone-forge"      },
                        "3":    { "name": "keyword.control.section.dragonstone-forge"                   },
                        "4":    { "name": "punctuation.definition.section.end.dragonstone-forge"        },
                        "5":    { "name": "punctuation.definition.section.end.dragonstone-forge"        }
                    }
                },
                {
                    "name":     "meta.section.table.array.dragonstone-forge",
                    "match":    "^\\s*(\\[)(\\[)\\s*([^\\]\\n]+?)\\s*(\\])(\\])\\s*(?:#.*)?$",
                    "captures": {
                        "1":    { "name": "punctuation.definition.section.begin.dragonstone-forge"      },
                        "2":    { "name": "punctuation.definition.section.begin.dragonstone-forge"      },
                        "3":    { "name": "keyword.control.section.dragonstone-forge"                   },
                        "4":    { "name": "punctuation.definition.section.end.dragonstone-forge"        },
                        "5":    { "name": "punctuation.definition.section.end.dragonstone-forge"        }
                    }
                },
                {
                    "name":     "meta.section.table.dragonstone-forge",
                    "match":    "^\\s*(\\[)\\s*([^\\]\\n]+?)\\s*(\\])\\s*(?:#.*)?$",
                    "captures": {
                        "1":    { "name": "punctuation.definition.section.begin.dragonstone-forge"      },
                        "2":    { "name": "keyword.control.section.dragonstone-forge"                   },
                        "3":    { "name": "punctuation.definition.section.end.dragonstone-forge"        }
                    }
                }
            ]
        },
        "assignments": {
            "patterns": [
                {
                    "name":     "meta.assignment.dragonstone-forge",
                    "match":    "(?:^|,|\\{)\\s*([A-Za-z0-9_][A-Za-z0-9_\\-]*(?:\\.[A-Za-z0-9_][A-Za-z0-9_\\-]*)*)\\s*(=)",
                    "captures": {
                        "1":    { "name": "variable.parameter.dragonstone-forge"                        },
                        "2":    { "name": "keyword.operator.assignment.dragonstone-forge"               }
                    }
                }
            ]
        },
        "values": {
            "patterns": [
                { "include":    "#strings"          },
                { "include":    "#numbers"          },
                { "include":    "#booleans"         },
                { "include":    "#nil"              },
                { "include":    "#dates"            },
                { "include":    "#arrays"           },
                { "include":    "#inlineTables"     }
            ]
        },
        "strings": {
            "patterns": [
                {
                    "name":     "string.quoted.double.dragonstone-forge",
                    "begin":    "\"",
                    "end":      "\"",
                    "beginCaptures": {
                        "0":    { "name": "punctuation.definition.string.begin.dragonstone-forge"       }
                    },
                    "endCaptures": {
                        "0":    { "name": "punctuation.definition.string.end.dragonstone-forge"         }
                    },
                    "patterns": [
                        { 
                            "name":     "constant.character.escape.dragonstone-forge",
                            "match":    "\\\\(u\\{[0-9a-fA-F]+\\}|u[0-9a-fA-F]{4}|x[0-9a-fA-F]{2}|.)" 
                        }
                    ]
                },
                {
                    "name":     "string.quoted.single.dragonstone-forge",
                    "begin":    "'",
                    "end":      "'",
                    "beginCaptures": {
                        "0":    { "name":   "punctuation.definition.string.begin.dragonstone-forge"     }
                    },
                    "endCaptures": {
                        "0":    { "name":   "punctuation.definition.string.end.dragonstone-forge"       }
                    },
                    "patterns": [
                        { 
                            "name":     "constant.character.escape.dragonstone-forge", 
                            "match":    "\\\\." 
                        }
                    ]
                }
            ]
        },
        "numbers": {
            "patterns": [
                {
                    "name":     "constant.numeric.float.dragonstone-forge",
                    "match":    "(?<![\\w.-])[-+]?\\d+\\.\\d+([eE][-+]?\\d+)?(?![\\w.-])"
                },
                {
                    "name":     "constant.numeric.integer.dragonstone-forge",
                    "match":    "(?<![\\w.-])[-+]?\\d+(?![\\w.-])"
                }
            ]
        },
        "booleans": {
            "patterns": [
                {
                    "name":     "constant.language.boolean.dragonstone-forge",
                    "match":    "\\b(true|false)\\b"
                }
            ]
        },
        "nil": {
            "patterns": [
                {
                    "name":     "constant.language.null.dragonstone-forge",
                    "match":    "\\b(nil|null)\\b"
                }
            ]
        },
        "dates": {
            "patterns": [
                {
                    "name":     "constant.other.datetime.dragonstone-forge",
                    "match":    "\\b\\d{4}-\\d{2}-\\d{2}([Tt ]\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?([Zz]|[+-]\\d{2}:?\\d{2})?)?\\b"
                }
            ]
        },
        "arrays": {
            "patterns": [
                {
                    "name":     "meta.sequence.array.dragonstone-forge",
                    "begin":    "\\[",
                    "end":      "\\]",
                    "beginCaptures": {
                        "0":    { "name":     "punctuation.section.brackets.begin.dragonstone-forge"    }
                    },
                    "endCaptures": {
                        "0":    { "name":     "punctuation.section.brackets.end.dragonstone-forge"      }
                    },
                    "patterns": [
                        { "include":    "#comments"                                                     },
                        { "include":    "#values"                                                       },
                        { 
                            "name":     "punctuation.separator.comma.dragonstone-forge", 
                            "match":    "," 
                        }
                    ]
                }
            ]
        },
        "inlineTables": {
            "patterns": [
                {
                    "name":     "meta.mapping.inline-table.dragonstone-forge",
                    "begin":    "\\{",
                    "end":      "\\}",
                    "beginCaptures": {
                        "0":    { "name":   "punctuation.section.braces.begin.dragonstone-forge"        }
                    },
                    "endCaptures": {
                        "0":    { "name":   "punctuation.section.braces.end.dragonstone-forge"          }
                    },
                    "patterns": [
                        { "include":    "#comments"                                                     },
                        {
                            "name":     "meta.assignment.inline-table.dragonstone-forge",
                            "match":    "(?:^|,|\\{)\\s*([^=,#\\n]+?)\\s*(=)",
                            "captures": {
                                "1":    { "name": "variable.parameter.dragonstone-forge"                },
                                "2":    { "name": "keyword.operator.assignment.dragonstone-forge"       }
                            }
                        },
                        { "include":    "#values" },
                        { 
                            "name":     "punctuation.separator.comma.dragonstone-forge", 
                            "match":    "," 
                        }
                    ]
                }
            ]
        }
    },
    "scopeName": "source.dragonstone-forge"
}
